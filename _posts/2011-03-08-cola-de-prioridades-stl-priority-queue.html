---
layout: post
title: Cola de prioridades (STL priority_queue)
date: 2011-03-08
category: cpp
tags: [cpp, programacion, stl, list, queue]
---

<div class='post'>
La cola de prioridades es una estructura de datos que se puede visualizar como una bolsa, donde podemos ir metiendo elementos uno atrás del otro, pero sólo los podemos retirar según un criterio de prioridad. Por ejemplo, en el caso de un ladrón obsesivo-compulsivo, podría robar un banco cargando bolsas de dinero sin ningún criterio, y al vaciarla podría retirar los billetes según su valor (primero los de $100, luego los de $50, etc.).<br /><br />Otro ejemplo, imaginemos que tenemos un barco:<br /><pre class="prettyprint">#include &lt;queue&gt;<br />#include &lt;list&gt;<br /><br />using namespace std;<br /><br />class Barco {<br />public:<br />  void subirPasajero(const Pasajero& pasajero);<br />  void abandonarBarco(list&lt;Pasajero&gt;&amp; pasajerosEnOrden);<br /><br />private:<br />  priority_queue&lt;Pasajero&gt; pasajeros_;<br />};<br /></pre><br />La función subirPasajero() debe agregar un pasajero al barco, y abandonarBarco() debe sacar todos los pasajeros del barco y colocarlos (por orden de prioridad) en la lista que se recibe como argumento:<br /><pre class="prettyprint">void Barco::subirPasajero(const Pasajero&amp; pasajero)<br />{<br />  pasajeros_.push(pasajero);<br />}<br /><br />void Barco::abandonarBarco(list&lt;Pasajero&gt;&amp; pasajerosEnOrden)<br />{<br />  while (!pasajeros_.empty()) {<br />    pasajerosEnOrden.push_back(pasajeros_.top());<br />    pasajeros_.pop();<br />  }<br />}<br /></pre><br />Tenga en cuenta que la función miembro pop() de las colas en C++ (queue, priority_queue, etc.) no retornan el valor extraído. Esto es así para evitar crear copias de los objetos dentro de la cola. De este modo la función top() devuelve una referencia al elemento mismo que se encuentra en la cola, y pop() lo remueve sin devolver nada. Así nos evitamos de crear copias temporales de la instancia removida.<br /><br />Para poder usar la priority_queue sobre un tipo de dato propio (como Pasajero), debemos ofrecer una implementación del operator&lt;() para comparar distintas instancias de nuestro tipo de dato (este operador se utiliza para saber qué elemento debe salir último de la cola, es decir, el menor elemento tiene menor prioridad):<br /><pre class="prettyprint">enum Prioridad { Capitan, Hombre, Mujer, Ninio };<br /><br />class Pasajero {<br />public:<br />  Pasajero(Prioridad p) : prioridad_(p) { }<br /><br />  bool operator&lt;(const Pasajero&amp; otro) const {<br />    return prioridad_ &lt; otro.prioridad_;<br />  }<br /><br />  Prioridad prioridad() const { return prioridad_; }<br /><br />private:<br />  Prioridad prioridad_;<br />};<br /></pre><br />De este modo, el capitán tiene prioridad 0 y es tomado en cuenta como el de menor prioridad para abandonar el barco. Los pasajeros que mayor prioridad tienen de abandonar el barco son las mujeres y los niños. En este caso podrían tener igual prioridad, no tendría mucho sentido salvar a todos los niños sin sus respectivas madres.<br /><br />Ahora podemos crear un ejemplo:<br /><pre class="prettyprint">#include &lt;iostream&gt;<br /><br />using namespace std;<br /><br />int main()<br />{<br />  Barco titanic;<br />  titanic.subirPasajero(Pasajero(Capitan));<br />  titanic.subirPasajero(Pasajero(Mujer));<br />  titanic.subirPasajero(Pasajero(Hombre));<br />  titanic.subirPasajero(Pasajero(Mujer));<br />  titanic.subirPasajero(Pasajero(Ninio));<br />  titanic.subirPasajero(Pasajero(Hombre));<br />  titanic.subirPasajero(Pasajero(Ninio));<br />  // ...<br /><br />  list&lt;Pasajero&gt; pasajeros;<br />  titanic.abandonarBarco(pasajeros);<br />  <br />  for (list&lt;Pasajero&gt;::iterator it = pasajeros.begin(),<br />         end = pasajeros.end(); it != end; ++it) {<br />    cout &lt;&lt; it-&gt;prioridad() &lt;&lt; "\n";<br />  }<br />  <br />  return 0;<br />}<br /></pre>El anterior ejemplo imprime:<br /><pre class="console">3<br />3<br />2<br />2<br />1<br />1<br />0<br /></pre>Lo que significa que, sin importar el orden en el cual agregamos los pasajeros, primero extraemos los niños, luego las mujeres, los hombres, y finalmente el capitán.<br /><br />Más información:<br /><a href="http://www.cplusplus.com/reference/stl/priority_queue/">http://www.cplusplus.com/reference/stl/priority_queue/</a><br /><a href="http://en.wikipedia.org/wiki/Priority_queue">http://en.wikipedia.org/wiki/Priority_queue</a>
</div>
